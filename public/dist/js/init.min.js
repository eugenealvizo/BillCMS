$(document).ready(function(){
    var session = localStorage.getItem("bookClass");
    //Accordion
    $(document).find('.accordion_container').on('click','button, .accord_button', function(){
        if($(this).hasClass('active_button')){
            $('.accord_content').removeClass('active_accord');
            $('.accord_button').removeClass('active_button');
        }else{
            $('.accord_content').removeClass('active_accord');
            $('.accord_button').removeClass('active_button');
            $(this).next().addClass('active_accord');
            $(this).addClass('active_button');
        }
    });

    $('.box-nav').on('click', '.nav-opt', function() {
        var optId= $(this).data('opt');
        $(this).addClass('nav-active').siblings().removeClass('nav-active');
        $('.opt-content_container').find( '#' + optId).addClass('opt-active').siblings('.opt-content').removeClass('opt-active');
    });

    //Booking
    $('.book_class, .requests').on('click', '.class_sel', function(){
        $(this).addClass('class_active').siblings().removeClass('class_active');
        localStorage.setItem("bookClass", $(this).data('class'));
    });

    $('.book_class').on('click', '.class_sel', function(){
        var bookClass = $(this).data('book');
        $('.form-step01').find( '#' + bookClass).addClass('active_type').siblings().removeClass('active_type');
        $('.left').find('#' + bookClass).addClass('active').siblings('.summary').removeClass('active');
    });

    //SESSION
    $('.book_class').find('#' + session).addClass('class_active').siblings().removeClass('class_active');

    //Booking Progress/Steps
    $('.prog_buttons').on('click', 'button', function(){
        var prog = $(this).data('prog');
        var bookClass = $('.class_active').data('book');
        if(prog == 'next'){
            $('.booking-form').find( '.active_form').next().addClass('active_form').siblings().removeClass('active_form');
            $('.progress').find('.current').next().addClass('current').siblings().removeClass('current');
            $('.progress').sfind('.current').prev().addClass('done');
            if($('.active_form').hasClass('form-step02')){
                $('.prog_buttons').addClass('st02');
            }else{
                $('.prog_buttons').addClass('st03');
            }
        } else if (prog == 'back') {
            $('.booking-form').find( '.active_form').prev().addClass('active_form').siblings().removeClass('active_form');
            $('.progress').find('.current').prev().removeClass('done');
            $('.progress').find('.current').prev().addClass('current').siblings().removeClass('current');
            if($('.active_form').hasClass('form-step02')){
                $('.prog_buttons').removeClass('st03');
            }else{
                $('.prog_buttons').removeClass('st02');
            }
        } else{
            console.log('submit');
        }
        //Summary and Reminders
        if($('.form-step03').hasClass('active_form')){
            $('.reminders').addClass('active').siblings().removeClass('active');
        }else{
            $('.left').find('#' + bookClass).addClass('active').siblings().removeClass('active');
        }
    });

    //Room booking
     $(".check_div").on("click", ".take", function(){
        if($(this).hasClass("label")) {
            if($(this).hasClass("booked")) {
                $(this).removeClass("booked").text("Take this Room");
                $(this).siblings().removeClass("booked").removeAttr("checked");
                $(this).closest(".room").find(".numroom").removeClass("taken");
            }else{
                $(this).addClass('booked').text('Taken');
                $(this).siblings().addClass("booked").attr("checked", !0);
                $(this).siblings().addClass("booked").prop("checked", !0);
                $(this).closest(".room").find(".numroom").addClass("taken");
            }
        }else{
            if($(this).hasClass("booked")){
                $(this).removeClass("booked").removeAttr("checked");
                $(this).siblings().removeClass("booked").text("Take this Room");
                $(this).closest(".room").find(".numroom").removeClass("taken");
            }else{
                $(this).closest(".room").find(".numroom").addClass("taken");
                $(this).addClass("booked").attr("checked", !0);
                $(this).addClass("booked").prop("checked", !0);
                $(this).siblings().addClass("booked").text("Taken");
            }
        }

     });


    //Add Guests
    var guestctr = 0;
    $('.add_guests').on('click', 'a', function() {
        guestctr ++;
        var guest = 
        '<div class="guest_form" id="guest' + guestctr +'" >'+
            '<div class="holder">' +
                '<h5>First Name*</h5>' +
                '<input type="text" placeholder="What is your name?">' +
            '</div>'+
            '<div class="holder">' +
                '<h5>Last Name*</h5>' +
                '<input type="text" placeholder="What is your last name?">' +
            '</div>'+
            '<div class="remove" id="' + guestctr +'">'+ 
            '</div>'+
        '</div>' ;
        $('.guests_container').append(guest);
    });

    //Delete Guests
    $(document).on('click', '.remove', function(){
        $('#guest'+$(this).attr('id')).remove();
    });
    //j2
    var ctr = $('.opt-content').length;
    for (var  x = 0; x <= ctr; x++) {
    }

    //Slick
    $(".box-nav").slick({
      slidesToShow: 4,
      slidesToScroll: 4,
      responsive: [
        {
          breakpoint: 1024,
          settings: {
            slidesToShow: 3,
            slidesToScroll: 3,
          }
        },
        {
          breakpoint: 600,
          settings: {
            slidesToShow: 2,
            slidesToScroll: 2
          }
        },
        {
          breakpoint: 480,
          settings: {
            slidesToShow: 1,
            slidesToScroll: 1
          }
        }
      ]
    });

    //DATEPICKER
     $("#dtBox").DateTimePicker({
      dateSeparator: "/",
      dateFormat: "MM/dd/yyyy",
      timeFormat: "hh:mm AA"
    });

});




//IOS fixed
$('header').on('click', '.mob-menu', function() {
    if ($('.mob-menu').hasClass('mob-menu_active')) {
        $('.mob-menu').removeClass('mob-menu_active');
        $('nav').removeClass('nav-active');
        $('body').removeClass('stop-scrolling').css({'overflow': 'auto'});
        $('.mainwrap').css({'overflow': 'auto', 'height': 'auto'});
    } else {
        $('.mob-menu').addClass('mob-menu_active');
        $('nav').addClass('nav-active');
        $('body').addClass('stop-scrolling').css({'overflow': 'hidden'});
        $('.mainwrap').css({'overflow': 'hidden', 'height': '0'});
    }
});

/*$('nav').on('click', 'li', function(){
    if($(this).children('ul').hasClass('li-active')){
        $(this).children('ul').removeClass('li-active');
    }else{
    $('ul').removeClass('li-active');
        $(this).children('ul').addClass('li-active');
    }
});*/


function hashActive() {
    var active = window.location.hash.substr(1);
    $('.box-nav').find("[data-opt='" + active + "']").addClass('nav-active').siblings().removeClass('nav-active');
    $('.opt-content_container').find('#' + active).addClass('opt-active').siblings().removeClass('opt-active');
}

$(window).load(function() {
    hashActive();
});

$(window).on('hashchange', function(){
    hashActive();
});

$('.page-thingstodo .side').on('click', '.slick-arrow', function(){
    var h = $('.slick-track').find('.slick-current .sub-description h2').text();
    var p = $('.slick-track').find('.slick-current .sub-description p').text();
    $('.side .description').children('h2').text(h);
    $('.side .description').children('p').text(p);
});

//CHRIS

// functions
function boxNav(target){
    $(target).find(".box-nav").slick({
      slidesToShow: 4,
      slidesToScroll: 4,
      responsive: [
        {
          breakpoint: 1024,
          settings: {
            slidesToShow: 3,
            slidesToScroll: 3,
          }
        },
        {
          breakpoint: 600,
          settings: {
            slidesToShow: 2,
            slidesToScroll: 2
          }
        },
        {
          breakpoint: 480,
          settings: {
            slidesToShow: 1,
            slidesToScroll: 1
          }
        }
      ]
    }); 
}

function slickAct(where) {


    $(where).find('.slide-pagination').slick({
        mobileFirst: true,
        slidesToShow: 1,
        infinite: true,
        focusOnSelect: true,
        responsive: [
            {
                breakpoint:700,
                settings: {
                    slidesToShow: 2
                }
            },
            {
                breakpoint: 1000,
                settings: {
                    slidesToShow:3,
                    centerMode: true,
                    slidesToScroll: 1,
                    centerPadding: 0,

                }
            }
        ]
    });
}

$(document).ready(function(){
    var q = $('.img-vslider').find('.img-border').length;
    $('.img-vslider').find('.img-border:nth-child(even)').css({'transform': 'rotate(5deg)'});
    $('.img-vslider').find('.img-border:nth-child(odd)').css({'transform': 'rotate(-5deg)'});
    slickAct('.wheretoeat_container .opt-active');

});

$('.page-thingstodo').find('.box-nav_container .nav-opt').click(function(){
    $('.activities').css({'height':'0','overflow':'hidden'});
    $('.section-article').css({'min-height':'500px','height': 'auto','overflow':'auto'});
});

$('.box-nav').on('afterChange', function(){
    var optActive = $('.box-nav .slick-current').data('opt');
    $('.slick-current').addClass('nav-active').siblings().removeClass('nav-active');
    $('.opt-content_container').find('#' + optActive).addClass('opt-active').siblings().removeClass('opt-active');
    $('.activities').css({'height':'0','overflow':'hidden'});
    $('.section-article').css({'min-height':'500px','height': 'auto','overflow':'auto'});
    $('.other-hotels').css({'min-height': 'auto', 'height': 'auto', 'overflow': 'visible','padding': '20px 0px'});

});

$('.our-rooms .box-nav').on('afterChange', function(){
    var optActive = $('.our-rooms .box-nav .slick-current').data('opt');    
    $('.our-rooms .slick-current').addClass('nav-active').siblings().removeClass('nav-active');
    $('.our-rooms .opt-content_container').find('#' + optActive).addClass('opt-active').siblings().removeClass('opt-active');
    $('.mini-pop').css({'height': '0', 'overflow': 'hidden'});
    $('.section-article').show();
});

$('.mini-poprooms').click(function(){
    var room = $(this).data('room');
    $('.our-rooms').css({'height': 'auto'});
    $('.our-rooms').find('#'+room).addClass('active').siblings('.rooms_container').removeClass('active');
    $('.opt-active').find('.full-article').css({'min-height': '500px','height': 'auto', 'overflow': 'auto'});
    $('.other-hotels').css({'min-height': 'auto', 'height': 'auto', 'overflow': 'visible','padding': '20px 0px'});
    $('.our-hotels').css({'height': '0', 'overflow':'hidden'});
});

$('.place-btn').click(function(){
    $('.our-hotels').css({'height': 'auto'});
    $('.our-rooms').css({'height': '0', 'overflow':'hidden'});
});

$('.btn-tominipop').click(function(){
    $(this).closest('.opt-active').find('.image-output').empty();

    $(this).closest('.opt-active').find('.full-article').css({'min-height': '0','height': '0', 'overflow': 'hidden'});
    $('.other-hotels').css({'min-height': '0', 'height': '0', 'overflow': 'hidden','padding': '0'});
    $(this).closest('.opt-active').find('.mini-pop').css({'height': 'auto'});
    
    var clonePic = $(this).closest('.opt-active').find('.active-pic').clone();
    $(this).closest('.opt-active').find('.image-output').append(clonePic);

    var scr = $(this).closest('.opt-active').find('.image-output img').length;

    if(scr != 1) {
        $(this).closest('.opt-active').find('.image-output img:first').nextAll().remove();
    }
    slickAct('.opt-active .mini-pop');

});

$('.mini-pop .place-btn').click(function(){ 
    $('.opt-active').find('.full-article').css({'height':'auto','overflow': 'auto'});
    $('.opt-active').find('.mini-pop').css({'height':'0','min-height': '0','overflow':'hidden'});
    $('.mini-pop').find('.slide-pagination').slick('unslick');
});

$('.mini-pop .close').click(function(){
    $('.mini-pop').css({'height':'0','min-height': '0','overflow':'hidden'});
    $('.opt-active').find('.full-article').css({'min-height': '500px','height': 'auto', 'overflow': 'auto'});
    $('.opt-active').find('.other-hotels').css({'min-height': 'auto', 'height': 'auto', 'overflow': 'auto','padding': '20px 0px'});
    $('.mini-pop').find('.slide-pagination').slick('unslick');
    
});

// things to do
$('.page-thingstodo').find('.btn-main').click(function(){
    $('.opt-active').find('.image-output').empty();
    $('.opt-active .activities').css({'height':'auto','overflow':'auto'});
    $('.opt-active .section-article').css({'min-height':'0','height': '0','overflow':'hidden'});

    var clonePic = $('.opt-active').find('.active-pic').clone();
    var noClonePic = $('.opt-active').find('.slick-current .active-pic').clone();

    $('.opt-active').find('.image-output').append(clonePic);
    $('.opt-active').find('.image-output').append(noClonePic);
    slickAct('.opt-active .activities');
    
    var h = $('.activities .slick-track').find('.slick-current .sub-description h2').text();
    var p = $('.activities .slick-track').find('.slick-current .sub-description p').text();
    $('.side .description').children('h2').text(h);
    $('.side .description').children('p').text(p);
});

$('.act-close').click(function(){
    $('.activities').css({'height':'0','overflow':'hidden'});
    $('.section-article').css({'min-height':'500px','height': 'auto','overflow':'auto'});
    $('.opt-active .activities').find('.slide-pagination').slick('unslick');
});

// popup
if (jQuery('.pop-cover').length) {
    jQuery('.pop-cover').hide();

    jQuery(document).on('click', '.pop', function() {
        jQuery('body').addClass('stop-scrolling');
        jQuery('.mainwrap').css({'overflow': 'hidden', 'height': '0'});
        popcont = this.rel;

        jQuery('.pop-up').hide();
        jQuery('.pop-cover').fadeIn();
        jQuery('.' + popcont).show();

        // discover popup
        $('.'+popcont).children('.discover-container').find('.image-output').empty();   
        var clonePic = $('.'+popcont).children('.discover-container').find('.active-pic').clone();
        $('.'+popcont).children('.discover-container').find('.image-output').append(clonePic);
        slickAct('.discover-container');
        // popup details
        $('.room-detail_container').find('.image-output').empty();  
        var clonePic = $('.room-detail_container').find('.active-pic').clone();
        $('.room-detail_container').find('.image-output').append(clonePic);
        slickAct('.room-detail_container');
    });

    // close pop-up button
    jQuery('.close, .pop-holder, .close-tablet').on('click', function() {
      jQuery('.pop-up, .pop-cover ,.pop-in').fadeOut();  
      jQuery('body').removeClass('stop-scrolling');
      jQuery('.mainwrap').css({'overflow': 'visible', 'height': 'auto'});
      $('.discover-container').find('.slide-pagination').slick('unslick');
      $('.room-detail_container').find('.slide-pagination').slick('unslick');
    });
}
// home
$('.slider-banner').slick({
    prevArrow: $('.slanted-banner .prev'),
    nextArrow: $('.slanted-banner .next'),
});

// sliderchoose
var forvideo = $('.banner-booking_shortcut').hasClass('for-video');
var forslide = $('.banner-booking_shortcut').hasClass('for-slide');

if(forvideo) {
    $('.slanted-banner').remove();
}

if(forslide) {
    $('.video-banner').remove();
}

enquire.register("screen and (min-width: 1024px)",function(){
    $('#videobanner').YTPlayer();

});

$('.whatsnew-section').find('.container').slick({
    mobileFirst: true,
    responsive: [
        {
            breakpoint: 700,
            settings: {
                slidesToShow: 2,
            }
        },
        {
            breakpoint: 1000,
            settings: 'unslick',
        }
    ]
});

// vertical slide
$('.img-vslider').slick({
    vertical: true,
    verticalSwiping: false,
    slidesToShow: 3,
    arrows: false,
    dots: false,
    centerMode: false,
    autoplay: true, 
    autoplaySpeed: 0,
    speed: 12000,
    cssEase: 'linear',
});


$('.community-slide').slick({
    mobileFirst:true,
    responsive: [
        {
            breakpoint: 700,
            settings: {
                slidesToShow: 2,
            }
        },
        {
            breakpoint: 1000,
            settings: {
                slidesToShow: 3,
            }
        },
        {
            breakpoint: 1140,
            settings: {
                slidesToShow: 4,
            }
        },
        
    ]
});

// ellipsis
$('.article-landing').find('p').ellipsis({
    lines:4,
    responsive:true
});

$('.article-landing').find('h3').ellipsis({
    lines:2,
    responsive:true
});

$('.other-topics').find('p').ellipsis({
    lines:2,
    responsive:true
});

// promos events
if($.data('opt') == 'events') {
    // $('#events').css('border','solid');
    alert('yes');
}

var promoPage = $('.mainwrap').hasClass('promo-page');
var eventPage = $('.mainwrap').hasClass('event-page');
if(promoPage) {
    $('.promo-page').find('.promo-highlights').show();
    $('.promo-page').find('.event-highlights').hide();
} else if(eventPage) {
    $('.event-page').find('.promo-highlights').hide();
    $('.event-page').find('.event-highlights').show();
} else {
}

// 
/*function slideActive(activeSec){
    $(activeSec).find('.image-output').empty();

    var quix = $(activeSec).find('.slide-pagination .slick-current img').clone();
    $(activeSec).find('.image-output').append(quix);
    
    $(activeSec).find('.slide-pagination').on('afterChange',function(){
        var changePic = $(activeSec).find('.slide-pagination .slick-current img').clone();
        $(activeSec).find('.image-output').empty();     
        $(activeSec).find('.image-output').append(changePic);
    });
}
$(document).ready(function(){
    // places
    slideActive('.add_activeJunior');
    slideActive('.add_activeSeaside');
    slideActive('.add_activeDouble');
    slideActive('.add_activeMarine');

    // 
    slideActive('.add_slickFam');
    slideActive('.add_slickCouples');
    slideActive('.add_slickFriends');
    slideActive('.add_slickKids');

    // where to eat
    slideActive('.add_eatOne');
    slideActive('.add_eatTwo');
    slideActive('.add_eatThree');
    slideActive('.add_eatFour');
    slideActive('.add_eatFive');

    // popup
    slideActive('.add_slickPopDiscover01');
    slideActive('.add_slickPopDiscover02');
    slideActive('.add_slickPopDetails');

    // wheretoeat
    slickAct('.wheretoeat_container .opt-active');

});*/


function slideActive(activeSec){
    $('.'+activeSec).find('.image-output').empty();

    var quix = $('.'+activeSec).find('.slide-pagination .slick-current img').clone();
    $('.'+activeSec).find('.image-output').append(quix);
    
    $('.'+activeSec).find('.slide-pagination').on('afterChange',function(){
        var changePic = $('.'+activeSec).find('.slide-pagination .slick-current img').clone();
        $('.'+activeSec).find('.image-output').empty();        
        $('.'+activeSec).find('.image-output').append(changePic);
    });
}

$(document).ready(function(){
    $('.wheretoeat_container .opt-content').each(function (i) {
        var counter = i + 1
        $(this).find('.eat-spec').addClass("add_eat-"+ counter +"");
    });

    var cnt = $('.wheretoeat_container .opt-content_container .opt-content').length;
    var i = 1;

    for (i ; i<=cnt; i++){
        slideActive("add_eat-"+ i +"");    
    }

    // 
    slideActive('add_slickFam');
    // pop discover
    slideActive('add_slickPopDiscover01');
    slideActive('add_slickPopDiscover02');
    slideActive('add_slickPopDetails');

    // 
    slickAct('.wheretoeat_container .opt-active');

    //places
    $('.our-rooms .opt-content').each(function (x) {
        var ctr = x + 1
        $(this).find('.section-article_slide').addClass("place-"+ ctr +"");
    });

    var cntx = $('.our-rooms .opt-content').length;
    var x = 1;

    for (x ; x<=cntx; x++){
        slideActive("place-"+ x +"");   
    }
});

$('.box-nav').on('click', '.nav-opt', function() {
    var optId= $(this).data('opt');
    $(this).addClass('nav-active').siblings().removeClass('nav-active');
    $('.opt-content_container').find( '#' + optId).addClass('opt-active').siblings('.opt-content').removeClass('opt-active');
    $('.our-rooms .opt-active').find('.full-article').css({'min-height':'500px', 'overflow': 'auto', 'height':'auto'});
    $('.our-rooms .opt-active').find('.other-hotels').css({'overflow': 'auto', 'height':'auto', 'padding':'20px 0px'});
    // places 
    $('.mini-pop').find('.slide-pagination').slick('unslick');
    // things
    $('.activities').find('.slide-pagination').slick('unslick');
    // where to eat

    // $('.wheretoeat_container').find('.slide-pagination').slick('unslick');
    slickAct('.wheretoeat_container .opt-active');

    var quix = $('.wheretoeat_container .opt-active').find('.slide-pagination .slick-current img').clone();
    $('.wheretoeat_container .opt-active').find('.image-output').append(quix);
    
});

// progress-bar
Pace.on('done', function() {
  $('body').css({
    'overflow' : 'auto'
  });
  $('#progress').hide();
});

Pace.on('start', function(){
  $('body').css({
    'overflow' : 'hidden'
  });
});

Pace.start();